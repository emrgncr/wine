--- dlls/bcrypt/tests/bcrypt.c
+++ dlls/bcrypt/tests/bcrypt.c
@@ -2716,7 +2716,6 @@ static void test_SecretAgreement(void)
     ok(status == STATUS_INVALID_PARAMETER, "got %08x\n", status);
 
     status = pBCryptDeriveKey(secret, L"HASH", NULL, NULL, 0, &size, 0);
-    todo_wine
     ok(status == STATUS_SUCCESS, "got %08x\n", status);
 
     status = pBCryptDestroyHash(secret);
--- dlls/bcrypt/tests/bcrypt.c
+++ dlls/bcrypt/tests/bcrypt.c
@@ -3163,6 +3519,8 @@ START_TEST(bcrypt)
     test_BcryptDeriveKeyCapi();
     test_DSA();
     test_SecretAgreement();
+    test_dh_SecretAgreement();
+    test_dh_SecretAgreement_values();
 
     FreeLibrary(module);
 }
